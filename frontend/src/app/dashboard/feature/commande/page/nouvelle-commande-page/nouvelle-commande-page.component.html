<app-header></app-header>

<!-- Barre d'actions fixe (desktop) -->
<div class="nouvelle-commande-actions-bar" *ngIf="formGroup">
  <div class="nouvelle-commande-actions-bar__container">
    <div class="nouvelle-commande-actions-bar__left">
      <button 
        type="button" 
        class="btn-action-bar btn-toggle-prix"
        (click)="togglePrixFields()"
        [title]="showPrixFields() ? 'Masquer les frais' : 'Afficher les frais'">
        {{ showPrixFields() ? 'üí∞ Masquer frais' : 'üí∞ Afficher frais' }}
      </button>
      <button 
        type="button" 
        class="btn-action-bar btn-cancel"
        (click)="onCancel()"
        title="Annuler">
        ‚úï Annuler
      </button>
    </div>
    <div class="nouvelle-commande-actions-bar__right">
      <div class="attente-reponse-toggle-bar" *ngIf="!isVente()">
        <label class="toggle-switch-small" [class.toggle-vert]="getAttenteReponseControl().value" [class.toggle-rouge]="!getAttenteReponseControl().value">
          <input 
            type="checkbox" 
            [formControl]="getAttenteReponseControl()"
            class="toggle-input">
          <span class="toggle-slider"></span>
          <span class="toggle-label-small">{{ getAttenteReponseControl().value ? 'Rien √† faire' : 'Client attend' }}</span>
        </label>
      </div>
      <button type="submit" form="nouvelleCommandeForm" class="btn-action-bar btn-save" [disabled]="!isFormValid()">
        üíæ Cr√©er la {{ isVente() ? 'vente' : 'commande' }}
      </button>
    </div>
  </div>
</div>

<div class="nouvelle-commande-wrapper">
  <div class="nouvelle-commande-container">
    <!-- Popup de succ√®s -->
    <div class="success-popup-overlay" *ngIf="showSuccessPopup()" (click)="showSuccessPopup.set(false)">
      <div class="success-popup" (click)="$event.stopPropagation()">
        <div class="success-popup-header">
          <div class="success-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" fill="white"/>
            </svg>
          </div>
          <h3>{{ isVente() ? 'Vente bien enregistr√©e' : 'Commande bien enregistr√©e' }}</h3>
        </div>
        <div class="success-popup-body">
          <p>Votre {{ isVente() ? 'vente' : 'commande' }} a √©t√© cr√©√©e avec succ√®s !</p>
        </div>
        <div class="success-popup-actions">
          <button type="button" class="btn-success-outline" (click)="onCreateNewCommande()">
            Cr√©er une nouvelle {{ isVente() ? 'vente' : 'commande' }}
          </button>
          <button type="button" class="btn-success-filled" (click)="onViewCommandes()">
            Voir la {{ isVente() ? 'vente' : 'commande' }}
          </button>
        </div>
      </div>
    </div>
    
    <div class="error-area error-area--general" *ngIf="getGeneralError()">
      <p>{{ getGeneralError() }}</p>
    </div>

    <div class="detail-header">
      <div class="header-title-section">
        <div class="commande-type-toggle commande-type-toggle--top-right">
          <span class="commande-type-toggle__option" [class.active]="!isVente()">Commande</span>
          <label class="toggle-switch-small toggle-switch-small--neutral">
            <input
              type="checkbox"
              class="toggle-input"
              [checked]="isVente()"
              (change)="onTypeToggle($event)">
            <span class="toggle-slider"></span>
          </label>
          <span class="commande-type-toggle__option" [class.active]="isVente()">Vente</span>
        </div>
        <h1 class="page-title">Nouvelle {{ isVente() ? 'Vente' : 'Commande' }}</h1>
        <div class="commande-title-edit">
          <app-floating-label-input
            [label]="isVente() ? 'Nom / Intitul√© de la vente' : 'Nom / Intitul√© de la commande'"
            [control]="get('nom_commande')"
            [formGroup]="formGroup"
            [readonly]="false">
          </app-floating-label-input>
        </div>
      </div>
    </div>

    <form id="nouvelleCommandeForm" [formGroup]="formGroup" *ngIf="formGroup" (ngSubmit)="onSubmit()">
      
      <!-- Informations de la commande -->
      <section class="form-section">
        <h2 class="section-title">Informations de la {{ isVente() ? 'vente' : 'commande' }}</h2>
        
        <!-- Le champ nom_commande est maintenant dans le header, on ne l'affiche plus ici -->

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('date_commande')">
          <app-floating-label-input
            [label]="'Date de commande'"
            [control]="get('date_commande')"
            [formGroup]="formGroup"
            type="date">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('date_commande')">{{ getFieldErrorMessage('date_commande') }}</p>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('deadline')" *ngIf="!isVente()">
          <app-floating-label-input
            [label]="'Deadline'"
            [control]="get('deadline')"
            [formGroup]="formGroup"
            type="date">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('deadline')">{{ getFieldErrorMessage('deadline') }}</p>
        </div>

        <div class="input-wrapper">
          <div class="textarea-container">
            <textarea
              class="description-textarea"
              formControlName="description_projet"
              rows="4"
              placeholder=" "></textarea>
            <label class="textarea-label" [class.fixed-label]="get('description_projet').value && get('description_projet').value.length > 0">
              {{ isVente() ? 'Description' : 'Description du projet' }}
            </label>
          </div>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('dimensions_souhaitees')" *ngIf="!isVente()">
          <app-floating-label-input
            [label]="'Dimensions souhait√©es'"
            [control]="get('dimensions_souhaitees')"
            [formGroup]="formGroup">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('dimensions_souhaitees')">{{ getFieldErrorMessage('dimensions_souhaitees') }}</p>
        </div>

        <div class="input-wrapper" *ngIf="!isVente()">
          <app-floating-label-input
            #supportInput
            [label]="'Support'"
            [control]="get('support')!"
            [formGroup]="formGroup"
            [placeholder]="supportParDefaut">
          </app-floating-label-input>
          <p class="default-value-hint">Par d√©faut: {{ supportParDefaut }}</p>
        </div>

        <!-- Fichiers joints -->
        <div class="input-wrapper fichiers-joints-wrapper">
          <label class="label">Fichiers joints</label>
          <p class="fichiers-hint">Images (JPG, PNG, etc.), PDF, DOC/DOCX. Ils seront envoy√©s sur le stockage apr√®s la cr√©ation de la {{ isVente() ? 'vente' : 'commande' }}.</p>
          <div
            class="fichiers-drop-zone"
            [class.drag-over]="isDragOver"
            (click)="fileInputRef.click()"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)">
            <input
              #fileInputRef
              type="file"
              class="fichiers-input-hidden"
              multiple
              accept="image/*,.pdf,.doc,.docx"
              (change)="onFileSelected($event)"
              (click)="$event.stopPropagation()">
            <span class="fichiers-drop-text">Glissez des images ou des fichiers ici, ou cliquez pour parcourir</span>
          </div>
          <ul class="fichiers-list" *ngIf="uploadedFiles.length > 0">
            <li *ngFor="let file of uploadedFiles; let i = index" class="fichiers-list-item">
              <img *ngIf="file.type.startsWith('image/')" [src]="getFilePreviewUrl(file)" alt="" class="fichiers-list-thumb">
              <span class="fichiers-list-icon" *ngIf="!file.type.startsWith('image/')">üìÑ</span>
              <span class="fichiers-list-name" [title]="file.name">{{ file.name }}</span>
              <button type="button" class="fichiers-list-remove" (click)="removeFile(i); $event.stopPropagation()" title="Retirer">‚úï</button>
            </li>
          </ul>
        </div>

      </section>

      <!-- Coordonn√©es de contact -->
      <section class="form-section">
        <h2 class="section-title">Coordonn√©es de contact</h2>
        
        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('nom')">
          <app-floating-label-input
            [label]="'Nom'"
            [control]="get('nom')!"
            [formGroup]="formGroup">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('nom')">{{ getFieldErrorMessage('nom') }}</p>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('prenom')">
          <app-floating-label-input
            [label]="'Pr√©nom'"
            [control]="get('prenom')!"
            [formGroup]="formGroup">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('prenom')">{{ getFieldErrorMessage('prenom') }}</p>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('telephone')">
          <app-floating-label-input
            [label]="'T√©l√©phone'"
            [control]="get('telephone')!"
            [formGroup]="formGroup"
            type="tel">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('telephone')">{{ getFieldErrorMessage('telephone') }}</p>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('mail')">
          <app-floating-label-input
            [label]="'Email'"
            [control]="get('mail')!"
            [formGroup]="formGroup"
            type="email">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('mail')">{{ getFieldErrorMessage('mail') }}</p>
        </div>

        <!-- Adresse d√©compos√©e -->
        <div class="address-section">
          <label class="section-subtitle">Adresse</label>
          
          <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('rue')">
            <app-floating-label-input
              [label]="'Rue et num√©ro'"
              [control]="get('rue')!"
              [formGroup]="formGroup">
            </app-floating-label-input>
            <p class="field-error" *ngIf="getFieldErrorMessage('rue')">{{ getFieldErrorMessage('rue') }}</p>
          </div>

          <div class="form-row">
            <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('code_postal')">
              <app-floating-label-input
                [label]="'Code postal'"
                [control]="get('code_postal')!"
                [formGroup]="formGroup">
              </app-floating-label-input>
              <p class="field-error" *ngIf="getFieldErrorMessage('code_postal')">{{ getFieldErrorMessage('code_postal') }}</p>
            </div>
            
            <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('ville')">
              <app-floating-label-input
                [label]="'Ville'"
                [control]="get('ville')!"
                [formGroup]="formGroup">
              </app-floating-label-input>
              <p class="field-error" *ngIf="getFieldErrorMessage('ville')">{{ getFieldErrorMessage('ville') }}</p>
            </div>
          </div>

          <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('pays')">
            <app-floating-label-input
              [label]="'Pays'"
              [control]="get('pays')!"
              [formGroup]="formGroup">
            </app-floating-label-input>
            <p class="field-error" *ngIf="getFieldErrorMessage('pays')">{{ getFieldErrorMessage('pays') }}</p>
          </div>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('societe')">
          <app-floating-label-input
            [label]="'D√©nomination sociale'"
            [control]="get('societe')!"
            [formGroup]="formGroup">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('societe')">{{ getFieldErrorMessage('societe') }}</p>
        </div>

        <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('tva')">
          <app-floating-label-input
            [label]="'N¬∞ de TVA'"
            [control]="get('tva')!"
            [formGroup]="formGroup">
          </app-floating-label-input>
          <p class="field-error" *ngIf="getFieldErrorMessage('tva')">{{ getFieldErrorMessage('tva') }}</p>
        </div>

        <div class="input-wrapper">
          <label class="label">Mode de contact pr√©f√©r√©</label>
          <div class="mode-contact-radio-group">
            <label *ngFor="let mode of modesContact" class="mode-contact-radio-label">
              <input
                type="radio"
                name="mode_contact"
                [value]="mode.value"
                [formControl]="get('mode_contact')">
              <span class="mode-contact-emoji">{{ mode.emoji }}</span>
              <span>{{ mode.label }}</span>
            </label>
          </div>
        </div>
      </section>

      <!-- Prix et Frais -->
      <section class="form-section">
        <h2 class="section-title">Prix et Frais</h2>

        <!-- Quantit√© et Prix -->
        <div class="prix-quantity-group" *ngIf="!isVente()">
          <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('quantit√©')">
            <app-floating-label-input
              [label]="'Quantit√©'"
              [control]="get('quantit√©')"
              [formGroup]="formGroup"
              type="number">
            </app-floating-label-input>
            <p class="field-error" *ngIf="getFieldErrorMessage('quantit√©')">{{ getFieldErrorMessage('quantit√©') }}</p>
          </div>

          <div class="input-wrapper">
            <app-floating-label-input
              [label]="'Prix unitaire final'"
              [control]="get('prix_unitaire_final')"
              [formGroup]="formGroup"
              type="number"
              step="0.01"
              suffix="‚Ç¨">
            </app-floating-label-input>
          </div>

          <div class="input-wrapper">
            <app-floating-label-input
              [label]="'Prix final'"
              [control]="get('prix_final')"
              [formGroup]="formGroup"
              type="number"
              step="0.01"
              suffix="‚Ç¨">
            </app-floating-label-input>
          </div>
        </div>

        <div class="prix-quantity-group" *ngIf="isVente()">
          <div class="input-wrapper">
            <app-floating-label-input
              [label]="'Prix final'"
              [control]="get('prix_final')"
              [formGroup]="formGroup"
              type="number"
              step="0.01"
              suffix="‚Ç¨">
            </app-floating-label-input>
          </div>
        </div>

        <div class="input-wrapper">
          <div class="paye-status-block" [class.paye-oui]="get('pay√©').value" [class.paye-non]="!get('pay√©').value">
            <label class="checkbox-label-paye">
              <input
                type="checkbox"
                formControlName="pay√©"
                (change)="onPayeChange()">
              <span class="paye-label-text">{{ get('pay√©').value ? 'Pay√©' : 'Non pay√©' }}</span>
            </label>
            <div class="paye-commentaire-wrapper">
              <textarea
                class="paye-commentaire-input"
                formControlName="commentaire_paye"
                placeholder="Commentaire..."
                rows="3">
              </textarea>
            </div>
          </div>
        </div>

        <!-- Champs de prix du support (masqu√©s par d√©faut) -->
        <div class="prix-fields" *ngIf="showPrixFields()">
          <h3 class="supports-title">Support / Frais</h3>
          
          <!-- Liste des supports -->
          <div formArrayName="supports" class="supports-list">
            <div *ngFor="let supportControl of supportsFormArray.controls; let i = index" 
                 [formGroupName]="i" 
                 class="support-item">
              <ng-container [formGroup]="$any(supportControl)">
                <!-- Nom du support -->
                <div class="input-wrapper">
                  <app-floating-label-input
                    [label]="'Nom du support / frais'"
                    [control]="$any(supportControl).get('nom_support')!"
                    [formGroup]="$any(supportControl)">
                  </app-floating-label-input>
                </div>

                <!-- Toggle Prix support unitaire (au-dessus du champ prix support) -->
                <div class="support-toggle-row">
                  <label class="toggle-switch-small" [class.toggle-vert]="isPrixUnitaire($any(supportControl))" [class.toggle-rouge]="!isPrixUnitaire($any(supportControl))">
                    <input
                      type="checkbox"
                      formControlName="prix_unitaire"
                      class="toggle-input">
                    <span class="toggle-slider"></span>
                    <span class="toggle-label-small">{{ isPrixUnitaire($any(supportControl)) ? 'Prix unitaire' : 'Prix pour X unit√©s' }}</span>
                  </label>
                </div>

                <!-- Prix support et URL support sur la m√™me ligne -->
                <div class="support-price-url-row">
                  <div class="input-wrapper">
                    <app-floating-label-input
                      [label]="isPrixUnitaire($any(supportControl)) ? 'Prix unitaire' : 'Prix total'"
                      [control]="$any(supportControl).get('prix_support')!"
                      [formGroup]="$any(supportControl)"
                      type="number"
                      step="0.01"
                      suffix="‚Ç¨">
                    </app-floating-label-input>
                  </div>

                  <div class="input-wrapper">
                    <app-floating-label-input
                      [label]="'URL'"
                      [control]="$any(supportControl).get('url_support')!"
                      [formGroup]="$any(supportControl)">
                    </app-floating-label-input>
                  </div>
                </div>

                <!-- Texte "Le prix ci-dessus correspond √† X unit√©(s)" (en dessous du champ prix support total) -->
                <div class="support-prix-pour-unites" *ngIf="!isPrixUnitaire($any(supportControl))">
                  <span>Le prix ci-dessus correspond √†</span>
                  <input
                    type="number"
                    formControlName="nombre_unites"
                    class="nombre-unites-input"
                    [disabled]="isPrixUnitaire($any(supportControl))"
                    placeholder="X"
                    min="1">
                  <span>unit√©(s)</span>
                </div>

                <!-- Prix support unitaire calcul√© (read-only) -->
                <div class="input-wrapper calculated-field">
                  <app-floating-label-input
                    [label]="'Prix unitaire (calcul√©)'"
                    [control]="$any(supportControl).get('prix_support_unitaire')!"
                    [formGroup]="$any(supportControl)"
                    type="number"
                    step="0.01"
                    suffix="‚Ç¨"
                    [readonly]="true">
                  </app-floating-label-input>
                </div>
              </ng-container>

              <!-- Bouton supprimer -->
              <button
                type="button"
                class="btn-remove-support"
                (click)="removeSupport(i)"
                [disabled]="supportsFormArray.length <= 1"
                *ngIf="supportsFormArray.length > 1">
                Supprimer
              </button>
            </div>
          </div>

          <!-- Bouton ajouter support -->
          <button
            type="button"
            class="btn-add-support"
            (click)="addSupport()">
            + Ajouter un nouveau support / frais
          </button>

          <!-- R√©capitulatifs d√©taill√©s -->
          <div class="prix-recapitulatif">
            <h4 class="recap-title">D√©tails des frais</h4>
            <table class="recap-table">
              <thead>
                <tr>
                  <th>Support / Frais</th>
                  <th>Prix unitaire</th>
                  <th>Quantit√©</th>
                  <th>Prix total</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let supportControl of supportsFormArray.controls; let i = index">
                  <td class="support-name-cell">
                    {{ $any(supportControl).get('nom_support')?.value || 'Support ' + (i + 1) }}
                  </td>
                  <td class="price-cell">
                    {{ ($any(supportControl).get('prix_support_unitaire')?.value || 0) | number:'1.2-2' }} ‚Ç¨
                  </td>
                  <td class="quantity-cell">
                    {{ get('quantit√©').value || 1 }}
                  </td>
                  <td class="total-cell">
                    {{ (($any(supportControl).get('prix_support_unitaire')?.value || 0) * (get('quantit√©').value || 1)) | number:'1.2-2' }} ‚Ç¨
                  </td>
                </tr>
                <tr *ngIf="supportsFormArray.length === 0" class="empty-row">
                  <td colspan="4" class="empty-message">Aucun support</td>
                </tr>
                <tr class="total-row">
                  <td class="total-label"><strong>Total</strong></td>
                  <td class="total-cell"><strong>{{ get('prix_final_supports_unitaires').value || '0.00' }} ‚Ç¨</strong></td>
                  <td class="quantity-cell"><strong>{{ get('quantit√©').value || 1 }}</strong></td>
                  <td class="total-cell"><strong>{{ get('prix_final_supports').value || '0.00' }} ‚Ç¨</strong></td>
                </tr>
              </tbody>
            </table>
            <div class="recap-summary">
              <div class="recap-summary-item">
                <span class="recap-label"><strong>Prix final de vente :</strong></span>
                <span class="recap-value"><strong>{{ get('prix_final').value || '0.00' }} ‚Ç¨</strong></span>
              </div>
              <div class="recap-summary-item benefit-item">
                <span class="recap-label"><strong>Prix b√©n√©fice :</strong></span>
                <span class="recap-value benefit-value"><strong>{{ get('prix_benefice').value || '0.00' }} ‚Ç¨</strong></span>
              </div>
            </div>
          </div>
        </div>
      </section>
    </form>

    <!-- Personnalisation -->
    <section class="form-section form-section--spaced" *ngIf="!isVente()">
      <h2 class="section-title">Personnalisation</h2>

      <!-- Couleur (s√©lection multiple) -->
      <div class="input-wrapper">
        <label class="label">Couleur (s√©lection multiple)</label>
        <div class="couleurs-grid">
          <label 
            *ngFor="let couleur of couleursDisponibles" 
            class="couleur-checkbox-label"
            [class.selected]="isCouleurSelected(couleur)">
            <input 
              type="checkbox" 
              [checked]="isCouleurSelected(couleur)"
              (change)="toggleCouleur(couleur)"
              class="couleur-checkbox">
            <span class="couleur-label">{{ couleur }}</span>
          </label>
        </div>
      </div>

      <!-- Police d'√©criture -->
      <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('police_ecriture')">
        <app-floating-label-input
          [label]="'Police d\'√©criture'"
          [control]="get('police_ecriture')!"
          [formGroup]="formGroup">
        </app-floating-label-input>
        <p class="field-error" *ngIf="getFieldErrorMessage('police_ecriture')">{{ getFieldErrorMessage('police_ecriture') }}</p>
      </div>

      <!-- Texte de la personnalisation -->
      <div class="input-wrapper" [class.field-wrapper--error]="hasFieldError('texte_personnalisation')">
        <app-floating-label-input
          [label]="'Texte de la personnalisation'"
          [control]="get('texte_personnalisation')"
          [formGroup]="formGroup">
        </app-floating-label-input>
        <p class="field-error" *ngIf="getFieldErrorMessage('texte_personnalisation')">{{ getFieldErrorMessage('texte_personnalisation') }}</p>
      </div>
    </section>

    <!-- Statut initial de la commande -->
    <section class="statuts-section" *ngIf="!isVente()">
      <h2 class="section-title">Statut initial de la commande</h2>
      
      <div class="statuts-list">
        <label 
          *ngFor="let statut of statuts" 
          class="statut-radio-label"
          [class.selected]="isStatutSelected(statut)">
          <input 
            type="radio" 
            name="statut_initial"
            [value]="statut"
            [checked]="isStatutSelected(statut)"
            (change)="onStatutChange(statut)"
            class="statut-radio">
          <span class="statut-label">{{ statutLabels[statut] }}</span>
        </label>
      </div>
    </section>
  </div>

  <!-- Footer fixe mobile/tablette : Afficher frais, Annuler, Cr√©er la commande, + Toggle attente r√©ponse -->
  <footer class="form-actions-footer" *ngIf="formGroup">
    <div class="form-actions-footer__buttons">
      <div class="form-actions-footer__row">
        <button type="button" class="btn-footer btn-footer-prix" (click)="togglePrixFields()">
          {{ showPrixFields() ? 'üí∞ Masquer frais' : 'üí∞ Afficher frais' }}
        </button>
        <button type="button" class="btn-footer btn-secondary" (click)="onCancel()">Annuler</button>
      </div>
      <div class="form-actions-footer__row">
        <button type="submit" form="nouvelleCommandeForm" class="btn-footer btn-primary" [disabled]="!isFormValid()">
          Cr√©er la {{ isVente() ? 'vente' : 'commande' }}
        </button>
      </div>
    </div>
    <div class="form-actions-footer__toggle" *ngIf="!isVente()">
      <label class="toggle-switch-small toggle-switch-small--footer" [class.toggle-vert]="getAttenteReponseControl().value" [class.toggle-rouge]="!getAttenteReponseControl().value">
        <input
          type="checkbox"
          [formControl]="getAttenteReponseControl()"
          class="toggle-input">
        <span class="toggle-slider"></span>
        <span class="toggle-label-small">{{ getAttenteReponseControl().value ? 'Rien √† faire' : 'Client attend' }}</span>
      </label>
    </div>
  </footer>
</div>
